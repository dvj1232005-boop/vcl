<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Quy Ch·∫ø ‚Äì ƒêƒÉng k√Ω ca</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0b3c2d">

<style>
/* =====================================================
   üéÑ PROMAX CHRISTMAS ‚Äì FINTECH / iOS STYLE
===================================================== */
:root{
  --bg1:#050e0b;
  --bg2:#0b3c2d;
  --bg3:#124f41;
  --card:rgba(255,255,255,.92);
  --glass:rgba(255,255,255,.15);
  --text:#0f172a;
  --green:#1e7f6d;
  --red:#c62828;
  --border:rgba(255,255,255,.35);
}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,system-ui;
  background:
    radial-gradient(circle at top,rgba(255,255,255,.18),transparent 40%),
    linear-gradient(135deg,var(--bg1),var(--bg2),var(--bg3));
  min-height:100vh;
  display:flex;
  justify-content:center;
  color:var(--text);
  overflow-x:hidden;
}

/* ================= ‚ùÑÔ∏è SNOW ‚Äì MULTI LAYER ================= */
.snow{
  position:fixed;
  top:-10px;
  width:6px;
  height:6px;
  background:white;
  border-radius:50%;
  pointer-events:none;
  animation: fall linear infinite;
}
.snow.slow{opacity:.3}
.snow.mid{opacity:.6}
.snow.fast{opacity:.9}

@keyframes fall{
  to{transform:translateY(110vh)}
}

/* ================= LAYOUT ================= */
.container{
  width:100%;
  max-width:430px;
  padding:22px;
  position:relative;
  z-index:2;
}

/* ================= CARD PROMAX ================= */
.card{
  background:var(--card);
  border-radius:28px;
  padding:24px;
  box-shadow:
    0 40px 80px rgba(0,0,0,.45),
    inset 0 0 0 1px rgba(255,255,255,.6);
  backdrop-filter:blur(12px);
  animation: cardIn .7s cubic-bezier(.22,1,.36,1);
}
@keyframes cardIn{
  from{opacity:0;transform:translateY(40px) scale(.96)}
  to{opacity:1;transform:none}
}

/* ================= HEADER ================= */
.header{
  margin-bottom:8px;
}
.header h1{
  margin:0;
  font-size:22px;
  letter-spacing:.3px;
}
.header .sub{
  font-size:13px;
  opacity:.6;
}

/* ================= INPUT ================= */
input{
  width:100%;
  padding:14px;
  margin:16px 0;
  border-radius:18px;
  border:1px solid var(--border);
  font-size:15px;
  background:rgba(255,255,255,.85);
}

/* ================= TABLE ================= */
table{width:100%}
td{padding:8px 0}
.day{font-weight:700}

/* ================= SELECT ‚Äì PILL STYLE ================= */
select{
  width:100%;
  padding:12px;
  border-radius:999px;
  border:1px solid var(--border);
  transition:.25s;
  background:white;
}
select:not([value=""]){
  border-color:var(--green);
  box-shadow:0 0 0 2px rgba(30,127,109,.25);
}

/* ================= BUTTON PROMAX ================= */
button{
  margin-top:22px;
  width:100%;
  padding:16px;
  border:none;
  border-radius:999px;
  font-size:16px;
  font-weight:700;
  color:white;
  background:
    linear-gradient(135deg,#b71c1c,#e53935);
  box-shadow:
    0 16px 40px rgba(198,40,40,.45);
  cursor:pointer;
  transition:.25s;
}
button:hover{transform:translateY(-1px)}
button:active{transform:scale(.98)}
button:disabled{
  opacity:.6;
  cursor:not-allowed;
}

/* ================= MANAGER DASH ================= */
.manager-box{
  margin-top:22px;
  padding:18px;
  border-radius:22px;
  background:
    linear-gradient(135deg,rgba(255,255,255,.95),rgba(255,255,255,.85));
}
.manager-day{
  margin-top:16px;
  font-weight:800;
  color:var(--green);
}
.manager-shift{
  display:flex;
  justify-content:space-between;
  margin:6px 0 6px 10px;
}
.manager-count{
  background:var(--green);
  color:white;
  padding:2px 10px;
  border-radius:999px;
  font-size:12px;
}

/* ================= FOOTER ================= */
.copyright{
  margin-top:18px;
  text-align:center;
  font-size:12px;
  opacity:.75;
}
</style>
</head>

<body>

<!-- ‚ùÑÔ∏è TUY·∫æT PROMAX -->
<script>
for(let i=0;i<60;i++){
  const s=document.createElement("div");
  s.className="snow "+(i%3===0?"slow":i%3===1?"mid":"fast");
  s.style.left=Math.random()*100+"vw";
  s.style.animationDuration=(i%3===0?12:i%3===1?8:5)+"s";
  s.style.width=s.style.height=(i%3===0?8:i%3===1?6:4)+"px";
  document.body.appendChild(s);
}
</script>

<div class="container">
  <div class="card">
    <div class="header">
      <h1>üéÑ ƒêƒÉng k√Ω ca l√†m</h1>
      <div class="sub">Tu·∫ßn hi·ªán t·∫°i ‚Ä¢ An Quy Ch·∫ø</div>
    </div>

    <input id="nameInput" placeholder="üë§ Nh·∫≠p t√™n (Qu·∫£n l√Ω nh·∫≠p QuanLy)">
    <table id="scheduleTable"></table>

    <button id="submitBtn">üéÖ X√°c nh·∫≠n ƒëƒÉng k√Ω</button>

    <div id="managerBox" class="manager-box" style="display:none"></div>
  </div>

  <div class="copyright">
    ¬© 2025 An Quy Ch·∫ø ‚Ä¢ Developed by ƒê√†o ƒêƒÉng T√πng
  </div>
</div>

<!-- ================= LOGIC ‚Äì GI·ªÆ NGUY√äN ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getDatabase, ref, set, get, remove } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

const firebaseConfig={
  apiKey:"AIzaSyCK6yfVr9VBMGwhbvYMXkJqMoRjo4Om2LM",
  authDomain:"an-quy.firebaseapp.com",
  databaseURL:"https://an-quy-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId:"an-quy",
  storageBucket:"an-quy.firebasestorage.app",
  messagingSenderId:"672469940026",
  appId:"1:672469940026:web:a38e5b15bbeb2361b84203"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

const DAYS=["T2","T3","T4","T5","T6","T7","CN"];
const SHIFTS=[
 {id:"C1",label:"C1"},
 {id:"C2",label:"C2"},
 {id:"C3",label:"C3"},
 {id:"2C_C1_C2",label:"2C (C1+C2)"},
 {id:"2C_C2_C3",label:"2C (C2+C3)"},
 {id:"F1",label:"F1"},
 {id:"F2",label:"F2"}
];

const table=document.getElementById("scheduleTable");
DAYS.forEach(d=>{
 table.innerHTML+=`
 <tr>
  <td class="day">${d}</td>
  <td>
   <select id="day-${d}">
    <option value="">‚Äî Kh√¥ng l√†m ‚Äî</option>
    ${SHIFTS.map(s=>`<option value="${s.id}">${s.label}</option>`).join("")}
   </select>
  </td>
 </tr>`;
});

function getWeekKey(date){
 const d=new Date(Date.UTC(date.getFullYear(),date.getMonth(),date.getDate()));
 d.setUTCDate(d.getUTCDate()+4-(d.getUTCDay()||7));
 const y=new Date(Date.UTC(d.getUTCFullYear(),0,1));
 return d.getUTCFullYear()+"-W"+Math.ceil((((d-y)/86400000)+1)/7);
}
(async()=>{
 const now=new Date();
 const wk=getWeekKey(now);
 const r=ref(db,"meta/lastResetWeek");
 const s=await get(r);
 if(now.getDay()===1 && s.val()!==wk){
  await remove(ref(db,"dangKy"));
  await set(r,wk);
 }
})();

const btn=document.getElementById("submitBtn");
btn.onclick=async()=>{
 btn.disabled=true;
 const name=document.getElementById("nameInput").value.trim();
 if(!name){alert("Ch∆∞a nh·∫≠p t√™n");btn.disabled=false;return;}

 if(name==="QuanLy"){
  const box=document.getElementById("managerBox");
  box.style.display="block";
  box.innerHTML="<strong>üìä T·ªïng h·ª£p ƒëƒÉng k√Ω</strong>";
  const snap=await get(ref(db,"dangKy"));
  if(!snap.exists()){box.innerHTML+="<div>Ch∆∞a c√≥ d·ªØ li·ªáu</div>";btn.disabled=false;return;}
  const map={};
  snap.forEach(u=>{
    Object.entries(u.val().lich||{}).forEach(([d,c])=>{
      map[d]=map[d]||{};
      map[d][c]=map[d][c]||[];
      map[d][c].push(u.key);
    });
  });
  Object.keys(map).forEach(d=>{
    box.innerHTML+=`<div class="manager-day">üìÖ ${d}</div>`;
    Object.keys(map[d]).forEach(c=>{
      box.innerHTML+=`
        <div class="manager-shift">
          <span>${c}: ${map[d][c].join(", ")}</span>
          <span class="manager-count">${map[d][c].length}</span>
        </div>`;
    });
  });
  btn.disabled=false;
  return;
 }

 const lich={};
 DAYS.forEach(d=>{
  const v=document.getElementById("day-"+d).value;
  if(v) lich[d]=v;
 });
 await set(ref(db,"dangKy/"+name),{ten:name,lich,time:Date.now()});
 alert("üéâ G·ª≠i l·ªãch th√†nh c√¥ng");
 btn.disabled=false;
};

if("serviceWorker" in navigator){
 navigator.serviceWorker.register("sw.js");
}
</script>
</body>
</html>




